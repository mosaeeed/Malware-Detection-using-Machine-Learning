# Import Libraries
from final_hybrid_csv import CSV_READER
from ann_hybrid import ANN
import torch
import torch.nn as nn
import torch.utils.data as data
import numpy as np
from sklearn.metrics import confusion_matrix
from sklearn.preprocessing import label_binarize

# check if the cuda is installed 
device = torch.device('cuda:0' if torch.cuda.is_available() else 'cpu')
if torch.cuda.is_available(): 
    print("gpu availible")


# load the model
model = ANN().to(device)

learning_rate = 0.001

# load the optimizer
optimizer = torch.optim.Adam(model.parameters(), lr=learning_rate,weight_decay=0.001)

# load the check point path
PATH = 'model.pt'

checkpoint = torch.load(PATH)
model.load_state_dict(checkpoint['model_state_dict'])
optimizer.load_state_dict(checkpoint['optimizer_state_dict'])
epoch = checkpoint['epoch']
loss = checkpoint['loss']

model.eval()
print('fiinised')
