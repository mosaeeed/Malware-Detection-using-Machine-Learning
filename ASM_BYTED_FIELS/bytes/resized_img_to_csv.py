# Import Libraries
from PIL import Image
import numpy as np
import csv


# reading data for csv file
malwarelist=np.genfromtxt('trainLabels.csv',delimiter=",",dtype=str)
malwarelist=malwarelist[1:]


# Path to resized images(32x32) 
folder = '/home/mohamed/Documents/GP/Dynamic_Detection/datasets/image_32/'


# Below code read the images and then flatten their values(i.e. 32x32=1024). These values stored in the data_to_write list against their IDs and labels
c_files=['58kxhXouHzFd4g3rmInB','6tfw0xSL2FNHOCJBdlaA','a9oIzfw03ED4lTBCt52Y','cf4nzsoCmudt1kwleOTI','d0iHC6ANYGon7myPFzBe','da3XhOZzQEbKVtLgMYWv','fRLS3aKkijp4GH0Ds6Pv','IidxQvXrlBkWPZAfcqKT']
data_to_write=[]
for name in malwarelist:
    b = ".bytes"
    nam=name[0].strip('"')
    if nam not in c_files:
        loc = folder+nam + b
        img = np.asarray(Image.open(folder+nam+".png"))
        img = img.flatten()
        img= img.tolist()
        img.append(nam)
        img.append(name[1])
        data_to_write.append(img)
        

# Following commands generate the CSV from the values store in data_to_write list
myFile = open('data_new.csv', 'w', newline='')  
with myFile:  
    writer = csv.writer(myFile)
    writer.writerows(data_to_write)