import numpy as np
import csv

# Initializing the variables
path_tr='data_to_tra.csv'
path_futr='data_to_traFull.csv'
path_te='data_to_test.csv'
path_val='data_to_val.csv'
path_opc='500_reduce_opcode.csv'

# Reading the data from CSV
original=np.genfromtxt(path_opc,delimiter=",",dtype=str)

# Making training data CSV
temp=np.genfromtxt(path_tr,delimiter=",",dtype=str)

to_csv=[]

to_csv.append(original[0].tolist())

for i in original:
    if i[-2] in temp[:,-2]:
        to_csv.append(i.tolist())

myFile = open('n_500_data_to_tra.csv', 'w', newline='')  

with myFile:  
    writer = csv.writer(myFile)
    writer.writerows(to_csv)
    
    
# Making train full data CSV
temp=np.genfromtxt(path_futr,delimiter=",",dtype=str)

to_csv=[]

to_csv.append(original[0].tolist())

for i in original:
    if i[-2] in temp[:,-2]:
        to_csv.append(i.tolist())

myFile = open('n_500_data_to_traFull.csv', 'w', newline='')  

with myFile:  
    writer = csv.writer(myFile)
    writer.writerows(to_csv)
    
# Making test CSV
temp=np.genfromtxt(path_te,delimiter=",",dtype=str)

to_csv=[]

to_csv.append(original[0].tolist())

for i in original:
    if i[-2] in temp[:,-2]:
        to_csv.append(i.tolist())

myFile = open('n_500_data_to_test.csv', 'w', newline='')  

with myFile:  
    writer = csv.writer(myFile)
    writer.writerows(to_csv)
    
# Making validation CSV
temp=np.genfromtxt(path_val,delimiter=",",dtype=str)

to_csv=[]

to_csv.append(original[0].tolist())

for i in original:
    if i[-2] in temp[:,-2]:
        to_csv.append(i.tolist())

myFile = open('n_500_data_to_val.csv', 'w', newline='')  

with myFile:  
    writer = csv.writer(myFile)
    writer.writerows(to_csv)