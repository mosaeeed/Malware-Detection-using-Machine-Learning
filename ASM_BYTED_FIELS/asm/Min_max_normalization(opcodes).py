# Importing libraries and initializing variables
import numpy as np
import csv
path_tr='n_500_data_to_tra.csv'
path_futr='n_500_data_to_traFull.csv'
path_te='n_500_data_to_test.csv'
path_val='n_500_data_to_val.csv'

# In this section of code train data is normalize with respect to its max and min values against each feature
new_train_data = np.genfromtxt(path_tr, delimiter=",", dtype=str)
tra_data= new_train_data[1:,0:-2]
tra_lab=new_train_data[1:,-1]
tra_name=new_train_data[1:,-2]
tra_lab=tra_lab.astype(np.int)
tra_data=tra_data.astype(np.float)
tra_min=np.min(tra_data,axis=0)
tra_max=np.max(tra_data,axis=0)
tra_dom=np.subtract(tra_max,tra_min)
tra_dom=np.where(tra_dom == 0, 1, tra_dom)
img = np.subtract(tra_data,tra_min)
img = np.divide(img, tra_dom)
img= img.tolist()

for i in range(len(tra_lab)):
    img[i].append(tra_name[i])
    img[i].append(tra_lab[i])


myFile = open('nn_500_data_to_tra.csv', 'w', newline='')  

with myFile:  
    writer = csv.writer(myFile)
    writer.writerows(img)



# Validation data is normalized with respect to train data max and min values against each feature
new_valid_data = np.genfromtxt(path_val, delimiter=",", dtype=str)
valid_data= new_valid_data[1:,0:-2]
valid_name=new_valid_data[1:,-2]
valid_lab=new_valid_data[1:,-1]
valid_lab=valid_lab.astype(np.int)
valid_data=valid_data.astype(np.float)
img = np.subtract(valid_data,tra_min)
img = np.divide(img, tra_dom)
img= img.tolist()

for i in range(len(valid_lab)):
    img[i].append(valid_name[i])
    img[i].append(valid_lab[i])


myFile = open('nn_500_data_to_val.csv', 'w', newline='')  

with myFile:  
    writer = csv.writer(myFile)
    writer.writerows(img)
    
# In this section of code trainfull data is normalized with respect to its max and min values against each feature
new_x_data = np.genfromtxt(path_futr, delimiter=",", dtype=str)
x_data= new_x_data[1:,0:-2]
x_name=new_x_data[1:,-2]
x_lab=new_x_data[1:,-1]
x_lab=x_lab.astype(np.int)
x_data=x_data.astype(np.float)
x_min=np.min(x_data,axis=0)
x_max=np.max(x_data,axis=0)
x_dom=np.subtract(x_max,x_min)
x_dom=np.where(x_dom == 0, 1, x_dom)
img = np.subtract(x_data,x_min)
img = np.divide(img, x_dom)
img= img.tolist()

for i in range(len(x_lab)):
    img[i].append(x_name[i])
    img[i].append(x_lab[i])


myFile = open('nn_500_data_to_traFull.csv', 'w', newline='')  

with myFile:  
    writer = csv.writer(myFile)
    writer.writerows(img)
    
# Test data is normalized with respect to trainfull data max and min values against each feature
new_test_data = np.genfromtxt(path_te, delimiter=",", dtype=str)
test_data= new_test_data[1:,0:-2]
test_lab=new_test_data[1:,-1]
test_name=new_test_data[1:,-2]
test_lab=test_lab.astype(np.int)
test_data=test_data.astype(np.float)
img = np.subtract(test_data,x_min)
img = np.divide(img, x_dom)
img= img.tolist()

for i in range(len(test_lab)):
    img[i].append(test_name[i])
    img[i].append(test_lab[i])


myFile = open('nn_500_data_to_test.csv', 'w', newline='')  

with myFile:  
    writer = csv.writer(myFile)
    writer.writerows(img)
